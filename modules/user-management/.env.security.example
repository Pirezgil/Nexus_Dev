# Enhanced Security Configuration for ERP Nexus
# Copy this file to .env and modify values for your environment

# ==============================================
# JWT CONFIGURATION (CRITICAL - CHANGE IN PRODUCTION)
# ==============================================
JWT_SECRET=CHANGE-THIS-TO-STRONG-RANDOM-STRING-MIN-64-CHARS-PROD
JWT_REFRESH_SECRET=CHANGE-THIS-TO-DIFFERENT-STRONG-RANDOM-STRING-64-CHARS
JWT_EXPIRES_IN=15m
JWT_REFRESH_EXPIRES_IN=7d
JWT_ISSUER=erp-nexus
JWT_AUDIENCE=erp-nexus-client

# ==============================================
# SESSION SECURITY
# ==============================================
SESSION_ENCRYPTION_KEY=CHANGE-THIS-TO-STRONG-RANDOM-SESSION-KEY-MIN-32-CHARS
SESSION_TIMEOUT=86400000
SESSION_INACTIVITY_TIMEOUT=1800000
MAX_SESSIONS_PER_USER=5

# ==============================================
# PASSWORD SECURITY
# ==============================================
BCRYPT_SALT_ROUNDS=14
PASSWORD_MIN_LENGTH=12
PASSWORD_MIN_SCORE=3
PASSWORD_RESET_TOKEN_EXPIRES=900000

# ==============================================
# RATE LIMITING CONFIGURATION
# ==============================================
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100
LOGIN_RATE_LIMIT_MAX=5
LOGIN_RATE_LIMIT_WINDOW=900000
PASSWORD_RESET_RATE_LIMIT_MAX=3
PASSWORD_RESET_RATE_LIMIT_WINDOW=900000

# ==============================================
# SECURITY HEADERS AND CORS
# ==============================================
CORS_ORIGINS=https://yourdomain.com,https://www.yourdomain.com
CORS_CREDENTIALS=true
ALLOWED_HOSTS=yourdomain.com,api.yourdomain.com
TRUSTED_PROXIES=127.0.0.1,::1

# ==============================================
# ENCRYPTION AND HASHING
# ==============================================
ENCRYPTION_ALGORITHM=aes-256-gcm
HASH_ALGORITHM=sha256
PBKDF2_ITERATIONS=100000

# ==============================================
# MONITORING AND LOGGING
# ==============================================
LOG_LEVEL=info
SECURITY_LOG_LEVEL=warn
AUDIT_LOG_ENABLED=true
FAILED_LOGIN_THRESHOLD=5
SUSPICIOUS_ACTIVITY_THRESHOLD=10

# ==============================================
# DATABASE SECURITY
# ==============================================
DB_CONNECTION_TIMEOUT=30000
DB_QUERY_TIMEOUT=60000
DB_SSL_ENABLED=true
DB_SSL_REJECT_UNAUTHORIZED=true

# ==============================================
# REDIS SECURITY
# ==============================================
REDIS_PASSWORD=CHANGE-THIS-TO-STRONG-REDIS-PASSWORD
REDIS_TLS_ENABLED=true
REDIS_KEY_PREFIX=erp_nexus:

# ==============================================
# EMAIL SECURITY (for password reset, etc.)
# ==============================================
SMTP_TLS_ENABLED=true
SMTP_AUTH_REQUIRED=true
EMAIL_RATE_LIMIT=10
EMAIL_RATE_LIMIT_WINDOW=3600000

# ==============================================
# FILE UPLOAD SECURITY
# ==============================================
MAX_FILE_SIZE=5242880
ALLOWED_FILE_TYPES=image/jpeg,image/png,image/webp,application/pdf
UPLOAD_PATH=/secure/uploads
VIRUS_SCAN_ENABLED=false

# ==============================================
# API SECURITY
# ==============================================
API_VERSION=v1
API_RATE_LIMIT_ENABLED=true
API_KEY_REQUIRED=false
GRAPHQL_INTROSPECTION=false
GRAPHQL_PLAYGROUND=false

# ==============================================
# FEATURE FLAGS FOR SECURITY
# ==============================================
ENABLE_2FA=false
ENABLE_CAPTCHA=false
ENABLE_IP_WHITELIST=false
ENABLE_GEO_BLOCKING=false
ENABLE_DEVICE_FINGERPRINTING=true

# ==============================================
# COMPLIANCE AND PRIVACY
# ==============================================
GDPR_COMPLIANCE=true
DATA_RETENTION_DAYS=2555
AUDIT_TRAIL_RETENTION_DAYS=2555
PRIVACY_MODE=false

# ==============================================
# EXTERNAL SERVICES SECURITY
# ==============================================
WEBHOOK_SECRET=CHANGE-THIS-TO-WEBHOOK-SECRET
EXTERNAL_API_TIMEOUT=30000
EXTERNAL_API_RATE_LIMIT=100

# ==============================================
# DEVELOPMENT/TESTING (DO NOT USE IN PRODUCTION)
# ==============================================
NODE_ENV=production
DEBUG_MODE=false
SECURITY_TESTING=false
MOCK_AUTH_ENABLED=false